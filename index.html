<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Automatic Battle RPG - 3v3 Skill System</title>
    <link rel="stylesheet" href="style.css">
    <script src="js/gameConfig.js" defer></script>
    <script src="js/preparation.js" defer></script>
    <script src="js/statusEffects.js" defer></script>
    <script src="js/skills.js" defer></script>
    <script src="js/statusEffects_EXAMPLES.js" defer></script>
    <script src="js/heroes.js" defer></script>
    <script src="js/monsterTemplate.js" defer></script>
    <script src="js/equipment.js" defer></script>
    <script src="js/UI.js" defer></script>
    <script src="js/gameLoop.js" defer></script>
  </head>
  <body>
    <!-- Main Menu -->
    <div id="main-menu" class="main-menu active">
      <div class="menu-content">
        <h1>âš”ï¸ Automatic Battle RPG</h1>
        <p>Select Difficulty</p>
        <div class="difficulty-buttons">
          <button onclick="startGameWithDifficulty('relax')" class="difficulty-btn">
            ğŸŒ¸ RELAX<br><small>Easier battles</small>
          </button>
          <button onclick="startGameWithDifficulty('normal')" class="difficulty-btn">
            âš”ï¸ NORMAL<br><small>Balanced difficulty</small>
          </button>
          <button onclick="startGameWithDifficulty('focus')" class="difficulty-btn">
            ğŸ”¥ FOCUS<br><small>Harder battles</small>
          </button>
        </div>
      </div>
    </div>

    <!-- Battle Log Tab (Left Side) -->
    <div id="battle-log-tab" class="battle-log-tab">
      <button id="log-toggle-btn" class="log-toggle-btn" onclick="toggleBattleLog()">ğŸ“‹</button>
      <div id="battle-log" class="log" style="display:none;"></div>
    </div>

    <!-- Settings Panel -->
    <div id="settings-panel" class="settings-panel">
      <button class="close-settings-btn" onclick="closeSettings()">âœ•</button>
      <h3>âš™ï¸ Settings</h3>
      <div class="settings-content">
        <div class="setting-item">
          <label>
            <input type="checkbox" id="auto-eq-select" onchange="saveSettings()">
            Auto-select Equipment
          </label>
          <small>Automatically choose equipment during transitions</small>
          <label class="indent" id="auto-eq-pause-label" style="display:none;">
            <input type="checkbox" id="auto-eq-pause" onchange="saveSettings()">
            Don't pause during quick-rest
          </label>
        </div>

        <div class="setting-item">
          <label>
            <input type="checkbox" id="auto-sk-select" onchange="saveSettings()">
            Auto-select Skill
          </label>
          <small>Automatically choose skill during transitions</small>
          <label class="indent" id="auto-sk-pause-label" style="display:none;">
            <input type="checkbox" id="auto-sk-pause" onchange="saveSettings()">
            Don't pause during long-rest
          </label>
        </div>
      </div>
    </div>

    <div class="game">
      <h1>âš” Area > Round > Set Battle System</h1>
      <div id="stage-info" class="stage-info">Area 1 - Round 1 - Set 1</div>
      <div id="rest-mode-indicator" class="rest-mode-indicator" style="display:none;">
        ğŸ’¤ REST MODE - You can change equipment, enhance stats, or modify skills now!
      </div>
      <div class="battlefield">
        <!-- Battle Map Grid 8x8 -->
        <div class="battle-map-section">
          <h2>Battle Map</h2>
          <div id="spawn-direction-indicator" class="spawn-direction">ğŸ§­ --</div>
          <div id="battle-map-grid" class="battle-map-grid"></div>
        </div>
        <!-- Battle Info Section -->
        <div class="battle-info-section">
          <div class="team heroes-section">
            <h2>Heroes</h2>
            <div id="heroes" class="heroes-container"></div>
          </div>
          <div class="team monsters-section">
            <h2>Monsters</h2>
            <div id="monsters" class="monsters-container"></div>
          </div>
        </div>
      </div>
      <div class="controls">
        <button id="start-btn" onclick="startBattle()">Start Battle</button>
        <button id="pause-btn" onclick="togglePause()" style="display:none;">â¸ Pause (SPACE)</button>
        <button id="next-round-btn" style="display:none;" onclick="nextRound()">â¡ Next Round</button>
        <button id="settings-btn" class="settings-btn" onclick="openSettings()">âš™ï¸</button>
      </div>
    </div>

    <!-- Profile Panel at Bottom -->
    <div id="profile-container" class="profile-container">
      <div class="profile-header">
        <h2 id="profile-name">Select a Hero</h2>
        <button class="close-profile-btn" onclick="closeProfile()">âœ•</button>
      </div>
      
      <div class="profile-content" id="profile-normal-content">
        <!-- Left: Stats and Equipment -->
        <div class="profile-left">
          <!-- Stats Section -->
          <div class="profile-section">
            <h3>ğŸ“Š Base Stats</h3>
            <div id="profile-base-stats" class="profile-stats-grid"></div>
          </div>
          
          <!-- Equipment Section -->
          <div class="profile-section">
            <h3>âš”ï¸ Equipment</h3>
            <div id="profile-equipment-list" class="profile-equipment-items"></div>
          </div>
        </div>
        
        <!-- Right: Skills and Buying -->
        <div class="profile-right">
          <!-- Skills Section -->
          <div class="profile-section">
            <h3>ğŸ”® Skills</h3>
            <div id="profile-skills-list" class="profile-skills-items"></div>
            <div id="skill-description" class="description-panel" style="display:none;">
              <h4 id="skill-desc-name"></h4>
              <p id="skill-desc-text"></p>
            </div>
          </div>
          
          <!-- Buy Stats Section -->
          <div class="profile-section">
            <h3>ğŸ’° Upgrade Stats (EXP: <span id="profile-exp">0</span>)</h3>
            <div id="profile-buy-stats" class="profile-buy-items"></div>
          </div>
          
          <!-- Item Description -->
          <div id="item-description" class="description-panel" style="display:none;">
            <h4 id="item-desc-name"></h4>
            <p id="item-desc-stats"></p>
            <p id="item-desc-ability"></p>
            <p id="item-desc-lore"></p>
          </div>
        </div>
      </div>

      <!-- Equipment & Skill Choice UI (shows during transitions) -->
      <div class="profile-content" id="profile-choice-content" style="display:none;">
        <!-- Transition Title -->
        <div class="profile-section" style="grid-column: 1/-1; text-align: center;">
          <h2 id="transition-title" style="margin: 8px 0;">Transition</h2>
          <p id="transition-rewards" style="font-size: 10px; color: #cbd5e1; margin: 4px 0;"></p>
        </div>

        <!-- Equipment Choice -->
        <div class="profile-section">
          <h3>ğŸ Choose Equipment</h3>
          <div id="eq-choice-list" class="profile-equipment-items"></div>
        </div>

        <!-- Skill Choice -->
        <div class="profile-section">
          <h3>ğŸ“š Choose Skill</h3>
          <div id="sk-choice-list" class="profile-skills-items"></div>
        </div>

        <!-- Continue Button -->
        <div class="profile-section" style="grid-column: 1/-1; text-align: center; margin-top: 8px;">
          <button onclick="continueFromTransition()" style="width: 80%; padding: 8px; font-size: 12px; background: #10b981; cursor: pointer;" id="continue-btn" disabled>
            â¡ Continue (Select both)
          </button>
        </div>
      </div>
    </div>
    </div>

      <!-- TRANSITION MODAL (Round/Area Pause) -->
      <div id="transition-modal" class="modal">
        <div class="modal-content">
          <h2 id="transition-title"></h2>
          <div id="transition-rewards">
            <p id="reward-text"></p>
            <div id="reward-items"></div>
          </div>
          <button class="btn-continue" onclick="continueFromTransition()">â¡ Continue</button>
        </div>
      </div>

    <!-- Game Over Modal -->
    <div id="gameover-modal" class="modal">
      <div class="modal-content">
        <h2>ğŸ’€ GAME OVER</h2>
        <p id="gameover-text"></p>
        <div class="modal-buttons">
          <button class="btn-continue" onclick="continueFromGameOver()">â†» Try Again</button>
          <button class="btn-continue" onclick="returnToMainMenu()">ğŸ  Main Menu</button>
        </div>
      </div>
    </div>
  </body>
</html>
